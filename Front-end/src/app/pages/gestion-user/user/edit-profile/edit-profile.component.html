<!-- Start Breadcrumbs -->
<app-breadcrumbs title="Profile Settings" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
    <!--end col-->
    <div class="col-xxl-3">
        <div class="card overflow-hidden">
            <!-- Cover Image (No edit option here anymore) -->
            <div>
                <img src="../../../../../assets/images/hobbies.webp" alt="" id="cover-img" class="card-img-top profile-wid-img object-fit-cover" style="height: 200px;">
            </div>
            <div class="card-body pt-0 mt-n5">
                <div class="text-center">
                    <div class="profile-user position-relative d-inline-block mx-auto">
                        <!-- User Profile Image with edit option -->
                        <img [src]="currentUser.image || 'assets/images/users/32/avatar-1.jpg'" alt="" id="user-img" class="avatar-lg rounded-circle object-fit-cover border-0 img-thumbnail user-profile-image">
                        <div class="avatar-xs p-0 rounded-circle profile-photo-edit position-absolute end-0 bottom-0">
                            <!-- File input for the user profile image -->
                            <input id="profile-img-file-input" type="file" class="profile-img-file-input d-none" (change)="fileChange($event)">
                            <label for="profile-img-file-input" class="profile-photo-edit avatar-xs">
                                <span class="avatar-title rounded-circle bg-light text-body">
                                    <i class="bi bi-camera"></i>
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="mt-3">
                        <h5>{{currentUser.nom}} {{currentUser.prenom}} <i class="bi bi-patch-check-fill align-baseline text-info ms-1"></i></h5>
                        <!-- <p class="text-muted">Web Developer</p> -->
                    </div>
                </div>
            </div>
            <div class="card-body border-top">
                <div class="d-flex align-items-center mb-4 pb-2">
                    <div class="flex-grow-1">
                        <h5 class="card-title mb-0">Complete Your Profile</h5>
                    </div>
                    <div class="flex-shrink-0">
                        <a href="javascript:void(0);" class="badge bg-light text-secondary"><i class="ri-edit-box-line align-bottom me-1"></i> Edit</a>
                    </div>
                </div>
                <div>
                    <progressbar class="animated-progress custom-progress progress-label" [value]="30">
                        <div class="label">30%</div>
                    </progressbar>
                </div>
            </div>
            <div class="card-body border-top">
                <div class="d-flex align-items-center mb-4">
                    <div class="flex-grow-1">
                        <h5 class="card-title mb-0">Portfolio</h5>
                    </div>
                    <div class="flex-shrink-0">
                        <a href="javascript:void(0);" class="badge bg-info-subtle text-info fs-xs"><i class="ri-add-fill align-bottom me-1"></i> Add</a>
                    </div>
                </div>
                <div class="mb-3 d-flex">
                    <div class="avatar-xs d-block flex-shrink-0 me-3">
                        <span class="avatar-title rounded-circle bg-dark-subtle text-dark">
                            <i class="bi bi-github"></i>
                        </span>
                    </div>
                    <input type="email" class="form-control" id="gitUsername" placeholder="Username" value="@richardmarshall">
                </div>
                <div class="mb-3 d-flex">
                    <div class="avatar-xs d-block flex-shrink-0 me-3">
                        <span class="avatar-title rounded-circle bg-primary-subtle text-primary">
                            <i class="bi bi-facebook"></i>
                        </span>
                    </div>
                    <input type="text" class="form-control" id="websiteInput" placeholder="www.example.com" value="www.steex.com">
                </div>
                <div class="mb-3 d-flex">
                    <div class="avatar-xs d-block flex-shrink-0 me-3">
                        <span class="avatar-title rounded-circle bg-success-subtle text-success">
                            <i class="bi bi-dribbble"></i>
                        </span>
                    </div>
                    <input type="text" class="form-control" id="dribbleName" placeholder="Username" value="@richard_marshall">
                </div>
                <div class="d-flex">
                    <div class="avatar-xs d-block flex-shrink-0 me-3">
                        <span class="avatar-title rounded-circle bg-danger-subtle text-danger">
                            <i class="bi bi-instagram"></i>
                        </span>
                    </div>
                    <input type="text" class="form-control" id="pinterestName" placeholder="Username" value="Richard Marshall">
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xxl-9">

        <div class="d-flex align-items-center flex-wrap gap-2 mb-4">
            <ul class="nav nav-pills arrow-navtabs nav-secondary gap-2 flex-grow-1 order-2 order-lg-1" role="tablist">
                <li class="nav-item" role="presentation">
                    <a class="nav-link active" data-bs-toggle="tab" href="javascript:void(0);" [class.active]="currentTab === 'personalDetails'" (click)="changeTab('personalDetails')" role="tab" aria-selected="true">
                        Personal Details
                    </a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" data-bs-toggle="tab" href="javascript:void(0);" [class.active]="currentTab === 'changePassword'" (click)="changeTab('changePassword')" role="tab" aria-selected="false" tabindex="-1">
                        Changes Password
                    </a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" data-bs-toggle="tab" href="javascript:void(0);" [class.active]="currentTab === 'education'" (click)="changeTab('education')" role="tab" aria-selected="false" tabindex="-1">
                        Education
                    </a>
                </li>
                <li class="nav-item" role="presentation">
                    <a class="nav-link" data-bs-toggle="tab" href="javascript:void(0);" [class.active]="currentTab === 'securityPrivacy'" (click)="changeTab('securityPrivacy')" role="tab" aria-selected="false" tabindex="-1">
                        Security & Privacy
                    </a>
                </li>
            </ul>
            <div class="flex-shrink-0 ms-auto order-1 order-lg-2">
                <a routerLink="/pages/profile-settings" class="btn btn-secondary"><i class="bi bi-pencil-square align-baseline me-1"></i> Edit Profile</a>
            </div>
        </div>
        <div class="card">
            <div class="tab-content">
                <div [hidden]="currentTab !== 'personalDetails'" class="tab-pane active" id="personalDetails" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Personal Details</h6>
                        </div>
                        <div class="card-body">
                            <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
                                <div class="row">
                                  <div class="col-lg-6">
                                    <div class="mb-3">
                                      <label for="firstnameInput" class="form-label">First Name</label>
                                      <input type="text" class="form-control" id="firstnameInput" formControlName="nom">
                                      <div *ngIf="userForm.get('nom')?.invalid && userForm.get('nom')?.touched" class="text-danger">
                                        First name is required.
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-6">
                                    <div class="mb-3">
                                      <label for="lastnameInput" class="form-label">Last Name</label>
                                      <input type="text" class="form-control" id="lastnameInput" formControlName="prenom">
                                      <div *ngIf="userForm.get('prenom')?.invalid && userForm.get('prenom')?.touched" class="text-danger">
                                        Last name is required.
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-6">
                                    <div class="mb-3">
                                      <label for="phonenumberInput" class="form-label">Phone Number</label>
                                      <input type="text" class="form-control" id="phonenumberInput" formControlName="tel">
                                      <div *ngIf="userForm.get('tel')?.invalid && userForm.get('tel')?.touched" class="text-danger">
                                        Phone number is invalid (should be 8 digits).
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-6">
                                    <div class="mb-3">
                                      <label for="emailInput" class="form-label">Email Address</label>
                                      <input type="email" class="form-control" id="emailInput" formControlName="email">
                                      <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="text-danger">
                                        Please provide a valid email address.
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-6">
                                    <div class="mb-3">
                                      <label for="birthDateInput" class="form-label">Birth Date</label>
                                      <input type="date" class="form-control" id="birthDateInput" formControlName="dateNaissance">
                                      <div *ngIf="userForm.get('dateNaissance')?.invalid && userForm.get('dateNaissance')?.touched" class="text-danger">
                                        Birth date must be in the past.
                                      </div>
                                    </div>
                                  </div>
                                  <div class="col-lg-6" *ngIf="isAgence()">
                                    <div class="mb-3">
                                      <label for="locationInput" class="form-label">Location</label>
                                      <input type="text" class="form-control" id="locationInput" formControlName="location">
                                    </div>
                                  </div>
                                  
                                  <div class="col-lg-12">
                                    <div class="hstack gap-2 justify-content-end">
                                      <button type="submit" class="btn btn-primary">Update</button>
                                      <button type="button" class="btn btn-subtle-danger" (click)="onCancel()">Cancel</button>
                                    </div>
                                  </div>
                                </div>
                              </form>
                              
                              
                        </div>
                    </div>
                </div>
                <div [hidden]="currentTab !== 'changePassword'" class="tab-pane active" id="changePassword" role="tabpanel">
                    <div class="card-header">
                        <h6 class="card-title mb-0">Change Password</h6>
                    </div>
                    <div class="card-body">
                        <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmitChangePassword()">
                            <div class="row g-3">
                          
                              <!-- Old Password -->
                              <div class="col-lg-4">
                                <label for="oldpasswordInput" class="form-label">Old Password*</label>
                                <div class="position-relative auth-pass-inputgroup">
                                  <input
                                    [type]="fieldTextType ? 'text' : 'password'"
                                    formControlName="oldPassword"
                                    class="form-control password-input pe-5"
                                    id="oldpasswordInput"
                                    placeholder="Enter current password"
                                    required
                                  />
                                  <button
                                    class="btn btn-link position-absolute end-0 top-0 text-decoration-none text-muted password-addon"
                                    type="button"
                                    (click)="toggleFieldTextType()"
                                  >
                                    <i
                                      class="ri-eye-fill align-middle"
                                      [ngClass]="{
                                        'mdi-eye-off-outline': !fieldTextType,
                                        'mdi-eye-outline': fieldTextType
                                      }"
                                    ></i>
                                  </button>
                                </div>
                              </div>
                          
                              <!-- New Password -->
                              <div class="col-lg-4">
                                <label for="newPasswordInput" class="form-label">New Password*</label>
                                <div class="position-relative auth-pass-inputgroup">
                                  <input
                                    [type]="fieldTextType1 ? 'text' : 'password'"
                                    formControlName="newPassword"
                                    class="form-control password-input pe-5"
                                    id="newPasswordInput"
                                    placeholder="Enter new password"
                                    required
                                  />
                                  <button
                                    class="btn btn-link position-absolute end-0 top-0 text-decoration-none text-muted password-addon"
                                    type="button"
                                    (click)="toggleFieldTextType1()"
                                  >
                                    <i
                                      class="ri-eye-fill align-middle"
                                      [ngClass]="{
                                        'mdi-eye-off-outline': !fieldTextType1,
                                        'mdi-eye-outline': fieldTextType1
                                      }"
                                    ></i>
                                  </button>
                                </div>
                              </div>
                          
                              <!-- Confirm Password -->
                              <!-- Confirm Password -->
                            <div class="col-lg-4">
                                <label for="confirmPasswordInput" class="form-label">Confirm Password*</label>
                                <div class="position-relative auth-pass-inputgroup">
                                <input
                                    [type]="fieldTextType2 ? 'text' : 'password'"
                                    formControlName="confirmPassword"
                                    class="form-control password-input pe-5"
                                    id="confirmPasswordInput"
                                    placeholder="Confirm password"
                                    required
                                />
                                <button
                                    class="btn btn-link position-absolute end-0 top-0 text-decoration-none text-muted password-addon"
                                    type="button"
                                    (click)="toggleFieldTextType2()"
                                >
                                    <i
                                    class="ri-eye-fill align-middle"
                                    [ngClass]="{
                                        'mdi-eye-off-outline': !fieldTextType2,
                                        'mdi-eye-outline': fieldTextType2
                                    }"
                                    ></i>
                                </button>
                                </div>
                            
                                <!-- Password mismatch error display - only show after both fields are touched -->
                                <div *ngIf="changePasswordForm.hasError('passwordMismatch') && 
                                            changePasswordForm.get('newPassword')?.touched && 
                                            changePasswordForm.get('confirmPassword')?.touched" 
                                    class="text-danger mt-2">
                                New password and confirmation do not match.
                                </div>
                            </div>
                          
                              <!-- Submit -->
                              <div class="col-12 d-flex justify-content-end mt-3">
                                <button type="submit" class="btn btn-success">Change Password</button>
                              </div>
                          
                            </div>
                          </form>
                          
                        <div class="mt-4 mb-4 pb-3 border-bottom d-flex justify-content-between align-items-center">
                            <h5 class="card-title  mb-0">Login History</h5>
                            <div class="flex-shrink-0">
                                <button type="button" class="btn btn-secondary">All Logout</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!--end tab-pane-->
                <div [hidden]="currentTab !== 'education'" class="tab-pane active" id="education" role="tabpanel">
                    <div class="card-header">
                        <h6 class="card-title mb-0">Education</h6>
                    </div>
                    <div class="card-body">
                        @for(formGroup of formGroups;track $index){
                            <div class="mt-3">
                            <form [formGroup]="educationForm">
                                <div id="newlink">
                                    <div id="1">
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="mb-3">
                                                    <label for="degreeName" class="form-label">Degree Name</label>
                                                    <input type="text" class="form-control" id="degreeName" placeholder="Degree name">
                                                </div>
                                            </div>
                                            <!--end col-->
                                            <div class="col-lg-6">
                                                <div class="mb-3">
                                                    <label for="universityName" class="form-label">University/school
                                                        Name</label>
                                                    <input type="text" class="form-control" id="universityName" placeholder="University/school name">
                                                </div>
                                            </div>
                                            <!--end col-->
                                            <div class="col-lg-6">
                                                <div class="mb-3">
                                                    <label for="passedYear" class="form-label">Passed Years</label>
                                                    <div class="row g-2 justify-content-center">
                                                        <div class="col-lg-5">
                                                            <select class="form-control" data-choices data-choices-search-false name="passedYear" id="passedYear">
                                                                <option value="">Select years</option>
                                                                <option value="Choice 1">2001</option>
                                                                <option value="Choice 2">2002</option>
                                                                <option value="Choice 3">2003</option>
                                                                <option value="Choice 4">2004</option>
                                                                <option value="Choice 5">2005</option>
                                                                <option value="Choice 6">2006</option>
                                                                <option value="Choice 7">2007</option>
                                                                <option value="Choice 8">2008</option>
                                                                <option value="Choice 9">2009</option>
                                                                <option value="Choice 10">2010</option>
                                                                <option value="Choice 11">2011</option>
                                                                <option value="Choice 12">2012</option>
                                                                <option value="Choice 13">2013</option>
                                                                <option value="Choice 14">2014</option>
                                                                <option value="Choice 15">2015</option>
                                                                <option value="Choice 16">2016</option>
                                                                <option value="Choice 17" selected>2017</option>
                                                                <option value="Choice 18">2018</option>
                                                                <option value="Choice 19">2019</option>
                                                                <option value="Choice 20">2020</option>
                                                                <option value="Choice 21">2021</option>
                                                                <option value="Choice 22">2022</option>
                                                            </select>
                                                        </div>
                                                        <!--end col-->
                                                        <div class="col-auto align-self-center">
                                                            to
                                                        </div>
                                                        <!--end col-->
                                                        <div class="col-lg-5">
                                                            <select class="form-control" data-choices data-choices-search-false>
                                                                <option value="">Select years</option>
                                                                <option value="Choice 1">2001</option>
                                                                <option value="Choice 2">2002</option>
                                                                <option value="Choice 3">2003</option>
                                                                <option value="Choice 4">2004</option>
                                                                <option value="Choice 5">2005</option>
                                                                <option value="Choice 6">2006</option>
                                                                <option value="Choice 7">2007</option>
                                                                <option value="Choice 8">2008</option>
                                                                <option value="Choice 9">2009</option>
                                                                <option value="Choice 10">2010</option>
                                                                <option value="Choice 11">2011</option>
                                                                <option value="Choice 12">2012</option>
                                                                <option value="Choice 13">2013</option>
                                                                <option value="Choice 14">2014</option>
                                                                <option value="Choice 15">2015</option>
                                                                <option value="Choice 16">2016</option>
                                                                <option value="Choice 17">2017</option>
                                                                <option value="Choice 18">2018</option>
                                                                <option value="Choice 19">2019</option>
                                                                <option value="Choice 20" selected>2020</option>
                                                                <option value="Choice 21">2021</option>
                                                                <option value="Choice 22">2022</option>
                                                            </select>
                                                        </div>
                                                        <!--end col-->
                                                    </div>
                                                    <!--end row-->
                                                </div>
                                            </div>
                                            <!--end col-->
                                            <div class="col-lg-12">
                                                <div class="mb-3">
                                                    <label for="degreeDescription" class="form-label">Degree
                                                        Description</label>
                                                    <textarea class="form-control" id="degreeDescription" rows="3" placeholder="Enter description"></textarea>
                                                </div>
                                            </div>
                                            <!--end col-->
                                            <div class="hstack gap-2 justify-content-end">
                                                <a class="btn btn-danger" href="javascript:void(0)" (click)="deleteForm($index)">Delete</a>
                                            </div>
                                        </div>
                                        <!--end row-->
                                    </div>
                                </div>
                                <div id="newForm" style="display: none;">
    
                                </div>
                                <div class="col-lg-12">
                                    <div class="hstack gap-2">
                                        <button type="submit" class="btn btn-secondary">Update</button>
                                        <a href="javascript:void(0);" class="btn btn-primary" (click)="addForm()">Add New</a>
                                    </div>
                                </div>
                                <!--end col-->
                            </form>
                        </div>
                        }
                    </div>
                </div>
                <!--end tab-pane-->
                <div [hidden]="currentTab !== 'securityPrivacy'" class="tab-pane active" id="securityPrivacy" role="tabpanel">
                    <div class="card-header">
                        <h6 class="card-title mb-0">Security & Privacy</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-4 pb-2">
                            <div class="d-flex flex-column flex-sm-row mb-4 mb-sm-0">
                                <div class="flex-grow-1">
                                    <h6 class="fs-md mb-1">Two-factor Authentication</h6>
                                    <p class="text-muted">Two-factor authentication is an enhanced security.
                                        Once
                                        enabled, you'll be required to give two types of identification when you
                                        log
                                        into Google Authentication and SMS are Supported.</p>
                                </div>
                                <div class="flex-shrink-0 ms-sm-3">
                                    <a href="javascript:void(0);" class="btn btn-sm btn-primary">Enable
                                        Two-factor
                                        Authentication</a>
                                </div>
                            </div>
                            <div class="d-flex flex-column flex-sm-row mb-4 mb-sm-0 mt-2">
                                <div class="flex-grow-1">
                                    <h6 class="fs-md mb-1">Secondary Verification</h6>
                                    <p class="text-muted">The first factor is a password and the second commonly
                                        includes a text with a code sent to your smartphone, or biometrics using
                                        your
                                        fingerprint, face, or retina.</p>
                                </div>
                                <div class="flex-shrink-0 ms-sm-3">
                                    <a href="javascript:void(0);" class="btn btn-sm btn-primary">Set up
                                        secondary
                                        method</a>
                                </div>
                            </div>
                            <div class="d-flex flex-column flex-sm-row mb-4 mb-sm-0 mt-2">
                                <div class="flex-grow-1">
                                    <h6 class="fs-md mb-1">Backup Codes</h6>
                                    <p class="text-muted mb-sm-0">A backup code is automatically generated for
                                        you
                                        when
                                        you turn on two-factor authentication through your iOS or Android
                                        Twitter
                                        app.
                                        You can also generate a backup code on twitter.com.</p>
                                </div>
                                <div class="flex-shrink-0 ms-sm-3">
                                    <a href="javascript:void(0);" class="btn btn-sm btn-primary">Generate backup
                                        codes</a>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <h5 class="card-title text-decoration-underline mb-3">Application Notifications:
                            </h5>
                            <ul class="list-unstyled mb-0">
                                <li class="d-flex">
                                    <div class="flex-grow-1">
                                        <label for="directMessage" class="form-check-label fs-md">Direct
                                            messages</label>
                                        <p class="text-muted">Messages from people you follow</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="directMessage" checked>
                                        </div>
                                    </div>
                                </li>
                                <li class="d-flex mt-2">
                                    <div class="flex-grow-1">
                                        <label class="form-check-label fs-md mb-1" for="desktopNotification">
                                            Show desktop notifications
                                        </label>
                                        <p class="text-muted">Choose the option you want as your default
                                            setting.
                                            Block
                                            a site: Next to "Not allowed to send notifications," click Add.</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="desktopNotification" checked>
                                        </div>
                                    </div>
                                </li>
                                <li class="d-flex mt-2">
                                    <div class="flex-grow-1">
                                        <label class="form-check-label fs-md mb-1" for="emailNotification">
                                            Show email notifications
                                        </label>
                                        <p class="text-muted"> Under Settings, choose Notifications. Under
                                            Select an
                                            account, choose the account to enable notifications for. </p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="emailNotification">
                                        </div>
                                    </div>
                                </li>
                                <li class="d-flex mt-2">
                                    <div class="flex-grow-1">
                                        <label class="form-check-label fs-md mb-1" for="chatNotification">
                                            Show chat notifications
                                        </label>
                                        <p class="text-muted">To prevent duplicate mobile notifications from the
                                            Gmail
                                            and Chat apps, in settings, turn off Chat notifications.</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="chatNotification">
                                        </div>
                                    </div>
                                </li>
                                <li class="d-flex mt-2">
                                    <div class="flex-grow-1">
                                        <label class="form-check-label fs-md mb-1" for="purchaesNotification">
                                            Show purchase notifications
                                        </label>
                                        <p class="text-muted">Get real-time purchase alerts to protect yourself
                                            from
                                            fraudulent charges.</p>
                                    </div>
                                    <div class="flex-shrink-0">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" role="switch" id="purchaesNotification">
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                      <div>
  <h5 class="card-title text-decoration-underline mb-3">Delete This Account:</h5>
  <p class="text-muted">Go to the Data & Privacy section of your profile Account.
      Scroll to "Your data & privacy options." Delete your Profile Account. Follow the instructions to delete your account:</p>
  <div>
      <input type="password" class="form-control" id="passwordInput" placeholder="Enter your password" value="richard@321654987" style="max-width: 265px;">
  </div>
  <div class="hstack gap-2 mt-3">
      <a href="javascript:void(0);" class="btn btn-subtle-danger" (click)="onDeleteAccount()">Close & Delete This Account</a>
      <a href="javascript:void(0);" class="btn btn-light">Cancel</a>
  </div>
</div>

                    </div>
                </div>
                <!--end tab-pane-->
            </div>
        </div>
    </div>
    <!--end col-->
</div>
<!--end row-->